\doxysection{request.\+hpp}
\hypertarget{request_8hpp_source}{}\label{request_8hpp_source}\index{source/core/include/abstract/request.hpp@{source/core/include/abstract/request.hpp}}
\mbox{\hyperlink{request_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ ST\_REQUEST\_QUEUE}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ ST\_REQUEST\_QUEUE}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <string.h>}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{print_8hpp}{misc/print.hpp}}"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{mpi_8hpp}{safety/mpi.hpp}}"{}}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceCommunication}{Communication}}}
\DoxyCodeLine{00011\ \{}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{namespaceCommunication_aab88a880cff454aa6315495785620452}{Operation}}}
\DoxyCodeLine{00014\ \{}
\DoxyCodeLine{00015\ \ \ \ \ \mbox{\hyperlink{namespaceCommunication_aab88a880cff454aa6315495785620452a5eede13bb50919b88c572539ccfb278b}{SEND}},}
\DoxyCodeLine{00016\ \ \ \ \ \mbox{\hyperlink{namespaceCommunication_aab88a880cff454aa6315495785620452afbd3c3a492b560c49a4cb5a8d62c6b7e}{RECV}},}
\DoxyCodeLine{00017\ \ \ \ \ \mbox{\hyperlink{namespaceCommunication_aab88a880cff454aa6315495785620452a8ef4e13659ec19643310483f030d9a5e}{BARRIER}}}
\DoxyCodeLine{00018\ \};}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{namespaceCommunication_a1899d3afd963389bd3735fa9773319b0}{GPUMemoryType}}}
\DoxyCodeLine{00021\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \mbox{\hyperlink{namespaceCommunication_a1899d3afd963389bd3735fa9773319b0a531c74101ac5c04706a9e2b58c5af0da}{COARSE}}\ =\ 1,}
\DoxyCodeLine{00023\ \ \ \ \ \mbox{\hyperlink{namespaceCommunication_a1899d3afd963389bd3735fa9773319b0ae290afb6eb0d81a62f79dd3eec3e9cda}{FINE}}\ \ \ =\ 2,}
\DoxyCodeLine{00024\ \};}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classCommunication_1_1Request}{Request}}}
\DoxyCodeLine{00027\ \{}
\DoxyCodeLine{00028\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00029\ \ \ \ \ \mbox{\hyperlink{namespaceCommunication_aab88a880cff454aa6315495785620452}{Operation}}\ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_af4a9c41bb9a95921b16678b3202a8339}{operation}};}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordtype}{void}*\ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_a22a681a7f529314661f2c66022fa5ab3}{buffer}};}
\DoxyCodeLine{00031\ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPI\_Count}}\ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_a082fc8d10763149b78a1e801e6c9e020}{count}};}
\DoxyCodeLine{00032\ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPI\_Datatype}}\ \mbox{\hyperlink{classCommunication_1_1Request_a63ff16eab5e78fe97d722781853bc414}{datatype}};}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ae23b436d3d9321b6c32fd3b1082385b5}{peer}};}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ae4bb45a0f4d83a55f8427baf2bbed5f4}{tag}};}
\DoxyCodeLine{00035\ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPI\_Comm}}\ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_aa93dfe4de07366db24b19e637516905e}{comm}};}
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPI\_Info}}\ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ad5e0d718454e1823ccd79debf5ff4fcd}{info}};}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_acb9c498b12490e69b89257d81478c673}{Request}}(\mbox{\hyperlink{namespaceCommunication_aab88a880cff454aa6315495785620452}{Operation}}\ \mbox{\hyperlink{classThreadQueue}{\_operation}},\ \textcolor{keywordtype}{void}*\ \mbox{\hyperlink{classThreadQueue}{\_buffer}},\ \mbox{\hyperlink{classThreadQueue}{MPI\_Count}}\ \mbox{\hyperlink{classThreadQueue}{\_count}},\ \mbox{\hyperlink{classThreadQueue}{MPI\_Datatype}}\ \mbox{\hyperlink{classThreadQueue}{\_datatype}},}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classThreadQueue}{\_peer}},\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classThreadQueue}{\_tag}},\ \mbox{\hyperlink{classThreadQueue}{MPI\_Comm}}\ \mbox{\hyperlink{classThreadQueue}{\_comm}},\ \mbox{\hyperlink{classThreadQueue}{MPI\_Info}}\ \mbox{\hyperlink{classThreadQueue}{\_info}})}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classCommunication_1_1Request_af4a9c41bb9a95921b16678b3202a8339}{operation}}(\mbox{\hyperlink{classThreadQueue}{\_operation}}),}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_a22a681a7f529314661f2c66022fa5ab3}{buffer}}(\mbox{\hyperlink{classThreadQueue}{\_buffer}}),}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_a082fc8d10763149b78a1e801e6c9e020}{count}}(\mbox{\hyperlink{classThreadQueue}{\_count}}),}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_a63ff16eab5e78fe97d722781853bc414}{datatype}}(\mbox{\hyperlink{classThreadQueue}{\_datatype}}),}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ae23b436d3d9321b6c32fd3b1082385b5}{peer}}(\mbox{\hyperlink{classThreadQueue}{\_peer}}),}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ae4bb45a0f4d83a55f8427baf2bbed5f4}{tag}}(\mbox{\hyperlink{classThreadQueue}{\_tag}}),}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_aa93dfe4de07366db24b19e637516905e}{comm}}(\mbox{\hyperlink{classThreadQueue}{\_comm}}),}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ad5e0d718454e1823ccd79debf5ff4fcd}{info}}(\mbox{\hyperlink{classThreadQueue}{\_info}}),}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_a6742b9585ab8540af8d309f56099e6b5}{myID}}(\mbox{\hyperlink{classCommunication_1_1Request_a1645c3d8c75a0cde08ec24cc824e8d73}{assignID}}()),}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ab369205fd50f89fe83ebbdb4c941a543}{matched}}(\mbox{\hyperlink{classThreadQueue}{false}})}
\DoxyCodeLine{00050\ \ \ \ \ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classThreadQueue}{size}}\ =\ -\/1;}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mpi_8hpp_ad46cf60a842fbe542c6ad4591944877c}{check\_mpi}}(\mbox{\hyperlink{classThreadQueue}{MPI\_Type\_size}}(\mbox{\hyperlink{classThreadQueue}{\_datatype}},\ \&\mbox{\hyperlink{classThreadQueue}{size}}));}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacePrint_af1ff8d85f2ff4ac7381b18677d35694a}{Print::out}}(\textcolor{stringliteral}{"{}Request\ made\ with\ address,\ size,\ count,\ tag,\ and\ ID:"{}},\ \mbox{\hyperlink{classThreadQueue}{\_buffer}},\ \mbox{\hyperlink{classThreadQueue}{size}},}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{\_count}},\ \mbox{\hyperlink{classCommunication_1_1Request_ae4bb45a0f4d83a55f8427baf2bbed5f4}{tag}},\ \mbox{\hyperlink{classCommunication_1_1Request_a6742b9585ab8540af8d309f56099e6b5}{myID}});}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classThreadQueue}{string\_size}}\ =\ 10;}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{info\_key}}[]\ \ =\ \textcolor{stringliteral}{"{}MPIS\_GPU\_MEM\_TYPE"{}};}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ \ \ \ \ \ \ \ \ \ value[\mbox{\hyperlink{classThreadQueue}{string\_size}}];}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{flag}}\ =\ 0;}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Pre\ MPI-\/4.0}}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classThreadQueue}{MPI\_INFO\_NULL}}\ !=\ \mbox{\hyperlink{classThreadQueue}{\_info}})}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mpi_8hpp_a12a06072344228a3fdd6d3ab2f1c4e48}{force\_mpi}}(\mbox{\hyperlink{classThreadQueue}{MPI\_Info\_get}}(\mbox{\hyperlink{classThreadQueue}{\_info}},\ \mbox{\hyperlink{classThreadQueue}{info\_key}},\ \mbox{\hyperlink{classThreadQueue}{string\_size}},\ value,\ \&\mbox{\hyperlink{classThreadQueue}{flag}}));}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (0\ ==\ \mbox{\hyperlink{classThreadQueue}{strcmp}}(value,\ \textcolor{stringliteral}{"{}FINE"{}}))}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacePrint_af1ff8d85f2ff4ac7381b18677d35694a}{Print::out}}(\textcolor{stringliteral}{"{}Using\ fine-\/grained\ memory!"{}});}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ac983540d6e9ae3b7afaaf7b5f810d167}{memory\_type}}\ =\ \mbox{\hyperlink{namespaceCommunication_a1899d3afd963389bd3735fa9773319b0ae290afb6eb0d81a62f79dd3eec3e9cda}{GPUMemoryType::FINE}};}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacePrint_af1ff8d85f2ff4ac7381b18677d35694a}{Print::out}}(\textcolor{stringliteral}{"{}Using\ coarse-\/grained\ memory!"{}});}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ac983540d6e9ae3b7afaaf7b5f810d167}{memory\_type}}\ =\ \mbox{\hyperlink{namespaceCommunication_a1899d3afd963389bd3735fa9773319b0a531c74101ac5c04706a9e2b58c5af0da}{GPUMemoryType::COARSE}};}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00076\ \ \ \ \ \};}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classCommunication_1_1Request_a43228a1e10a3ff1d147e53a6c4c0a155}{is\_matched}}()}
\DoxyCodeLine{00079\ \ \ \ \ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classCommunication_1_1Request_ab369205fd50f89fe83ebbdb4c941a543}{matched}};}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classCommunication_1_1Request_aa1e1e70a7b6ee5cbb86d6dc8ee068f03}{getID}}()}
\DoxyCodeLine{00084\ \ \ \ \ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classCommunication_1_1Request_a6742b9585ab8540af8d309f56099e6b5}{myID}};}
\DoxyCodeLine{00086\ \ \ \ \ \}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPI\_Request}}*\ \mbox{\hyperlink{classCommunication_1_1Request_a5ca5ecdf468a7ea6f01a2b6c07fcab63}{get\_match\_requests}}(\textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classThreadQueue}{num}})}
\DoxyCodeLine{00089\ \ \ \ \ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ad21515b19a647d7dcfd256b01e57d855}{match\_requests}}\ =\ std::vector<MPI\_Request>(\mbox{\hyperlink{classThreadQueue}{num}},\ \mbox{\hyperlink{classThreadQueue}{MPI\_REQUEST\_NULL}});}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_a1d81a01e8f7f3832b173900af2ee6901}{match\_statuses}}\ =\ std::vector<MPI\_Status>(\mbox{\hyperlink{classThreadQueue}{num}});}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classCommunication_1_1Request_ad21515b19a647d7dcfd256b01e57d855}{match\_requests}}.data();}
\DoxyCodeLine{00093\ \ \ \ \ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCommunication_1_1Request_a567d20c20be58cef953b07f2dad5c8e5}{wait\_on\_match}}()}
\DoxyCodeLine{00096\ \ \ \ \ \{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mpi_8hpp_ad46cf60a842fbe542c6ad4591944877c}{check\_mpi}}(\mbox{\hyperlink{classThreadQueue}{MPI\_Waitall}}(\mbox{\hyperlink{classCommunication_1_1Request_ad21515b19a647d7dcfd256b01e57d855}{match\_requests}}.size(),\ \mbox{\hyperlink{classCommunication_1_1Request_ad21515b19a647d7dcfd256b01e57d855}{match\_requests}}.data(),}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_a1d81a01e8f7f3832b173900af2ee6901}{match\_statuses}}.data()));}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ab369205fd50f89fe83ebbdb4c941a543}{matched}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00100\ \ \ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \ \ \mbox{\hyperlink{namespaceCommunication_a1899d3afd963389bd3735fa9773319b0}{GPUMemoryType}}\ \mbox{\hyperlink{classCommunication_1_1Request_a23c9b59800fba9e6bc97b30c1206b396}{get\_memory\_type}}()}
\DoxyCodeLine{00103\ \ \ \ \ \{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classCommunication_1_1Request_ac983540d6e9ae3b7afaaf7b5f810d167}{memory\_type}};}
\DoxyCodeLine{00105\ \ \ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_a6742b9585ab8540af8d309f56099e6b5}{myID}};}
\DoxyCodeLine{00109\ \ \ \ \ \mbox{\hyperlink{namespaceCommunication_a1899d3afd963389bd3735fa9773319b0}{GPUMemoryType}}\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ac983540d6e9ae3b7afaaf7b5f810d167}{memory\_type}};}
\DoxyCodeLine{00110\ \ \ \ \ std::vector<MPI\_Request>\ \mbox{\hyperlink{classCommunication_1_1Request_ad21515b19a647d7dcfd256b01e57d855}{match\_requests}};}
\DoxyCodeLine{00111\ \ \ \ \ std::vector<MPI\_Status>\ \ \mbox{\hyperlink{classCommunication_1_1Request_a1d81a01e8f7f3832b173900af2ee6901}{match\_statuses}};}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCommunication_1_1Request_ab369205fd50f89fe83ebbdb4c941a543}{matched}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classCommunication_1_1Request_a1645c3d8c75a0cde08ec24cc824e8d73}{assignID}}()}
\DoxyCodeLine{00115\ \ \ \ \ \{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classThreadQueue}{ID}}\ =\ 1;}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classThreadQueue}{ID}}++;}
\DoxyCodeLine{00118\ \ \ \ \ \}}
\DoxyCodeLine{00119\ \};}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \}\ \ \textcolor{comment}{//\ namespace\ Communication}}
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
