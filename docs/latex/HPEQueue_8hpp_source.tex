\doxysection{HPEQueue.\+hpp}
\hypertarget{HPEQueue_8hpp_source}{}\label{HPEQueue_8hpp_source}\index{source/core/include/queues/HPEQueue.hpp@{source/core/include/queues/HPEQueue.hpp}}
\mbox{\hyperlink{HPEQueue_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ ST\_HPE\_QUEUE}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ ST\_HPE\_QUEUE}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{queue_8hpp}{abstract/queue.hpp}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}mpi.h"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{mpi_8hpp}{safety/mpi.hpp}}"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <hip/hip\_runtime.h>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classHPEQueueEntry}{HPEQueueEntry}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classQueueEntry}{QueueEntry}}}
\DoxyCodeLine{00011\ \{}
\DoxyCodeLine{00012\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00013\ \ \ \ \ \mbox{\hyperlink{classHPEQueueEntry}{HPEQueueEntry}}(\mbox{\hyperlink{classThreadQueue}{MPI\_Request}}\ \mbox{\hyperlink{classThreadQueue}{req}});}
\DoxyCodeLine{00014\ \ \ \ \ \mbox{\hyperlink{classHPEQueueEntry_a48598ab01703f0fbaedd56087cafe167}{\string~HPEQueueEntry}}();}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHPEQueueEntry_ad6795f7f7f2cf2411dd2bead877e75b1}{prepare}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHPEQueueEntry_a188ea0861bf3fe12ac740532fe5d8c41}{start}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classHPEQueueEntry_abbbbc0ea4ee716ca56627ed94a48e3dc}{done}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHPEQueueEntry_a63bb449ff0e49cf5106b1459a4aa232e}{progress}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00023\ \};}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{template}<\textcolor{keywordtype}{bool}\ Direction>}
\DoxyCodeLine{00026\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classHPEQueueEntryP2P}{HPEQueueEntryP2P}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classHPEQueueEntry}{HPEQueueEntry}}}
\DoxyCodeLine{00027\ \{}
\DoxyCodeLine{00028\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00029\ \ \ \ \ \mbox{\hyperlink{classHPEQueueEntryP2P_a024dee457d53b825f9250e3924954059}{HPEQueueEntryP2P}}(\textcolor{keywordtype}{void}\ \ \ \ \ \ \ \ *\mbox{\hyperlink{classThreadQueue}{\_buffer}},}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{\_count}},}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPI\_Datatype}}\ \mbox{\hyperlink{classThreadQueue}{\_datatype}},}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{\_peer}},}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{\_tag}},}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ \ \ \ \ \ \ \ *\mbox{\hyperlink{classThreadQueue}{\_hpe\_stream}})}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ :\ \mbox{\hyperlink{classHPEQueueEntry}{HPEQueueEntry}}(\mbox{\hyperlink{classThreadQueue}{MPI\_REQUEST\_NULL}}),\ buffer(\mbox{\hyperlink{classThreadQueue}{\_buffer}}),\ count(\mbox{\hyperlink{classThreadQueue}{\_count}}),\ datatype(\mbox{\hyperlink{classThreadQueue}{\_datatype}}),}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ peer(\mbox{\hyperlink{classThreadQueue}{\_peer}}),\ tag(\mbox{\hyperlink{classThreadQueue}{\_tag}}),\ hpe\_stream((\mbox{\hyperlink{stream-triggering_8h_a65b7b573d26c5101388b9a4213303378}{MPIS\_Queue}}\ *)\ \mbox{\hyperlink{classThreadQueue}{\_hpe\_stream}})}
\DoxyCodeLine{00037\ \ \ \ \ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classHPEQueueEntryP2P_a2803879f5386d41929e90904fa9a832c}{prepare}}();\ \textcolor{comment}{//\ Do\ we\ like\ this?}}
\DoxyCodeLine{00039\ \ \ \ \ \};}
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{classHPEQueueEntryP2P_aad542036c3f277f7a79c7f328b72a87f}{\string~HPEQueueEntryP2P}}();}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHPEQueueEntryP2P_a2803879f5386d41929e90904fa9a832c}{prepare}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00043\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}(\mbox{\hyperlink{classThreadQueue}{Direction}})}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mpi_8hpp_a12a06072344228a3fdd6d3ab2f1c4e48}{force\_mpi}}(}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPIS\_Enqueue\_send}}(buffer,\ count,\ datatype,\ peer,\ tag,\ *hpe\_stream,\ \&\mbox{\hyperlink{classThreadQueue}{my\_request}}));}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mpi_8hpp_a12a06072344228a3fdd6d3ab2f1c4e48}{force\_mpi}}(}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPIS\_Enqueue\_recv}}(buffer,\ count,\ datatype,\ peer,\ tag,\ *hpe\_stream,\ \&\mbox{\hyperlink{classThreadQueue}{my\_request}}));}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHPEQueueEntryP2P_a275c2dd9d1cab3f7e5d9268965dbd888}{start}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00057\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mpi_8hpp_a12a06072344228a3fdd6d3ab2f1c4e48}{force\_mpi}}(\mbox{\hyperlink{stream-triggering_8h_a714d824d3adc59087d21a5aaf416433c}{MPIS\_Enqueue\_start}}(*hpe\_stream))}
\DoxyCodeLine{00059\ \ \ \ \ \}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classHPEQueueEntryP2P_adabc9b78d5f52ab212cef3a43f1caa24}{done}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHPEQueueEntryP2P_a099333067b85fc541388dd5823eabc3d}{progress}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordtype}{void}\ \ \ \ \ \ \ \ *buffer;}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ count;}
\DoxyCodeLine{00068\ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPI\_Datatype}}\ datatype;}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ peer;}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ tag;}
\DoxyCodeLine{00071\ \ \ \ \ \mbox{\hyperlink{stream-triggering_8h_a65b7b573d26c5101388b9a4213303378}{MPIS\_Queue}}\ \ *hpe\_stream;}
\DoxyCodeLine{00072\ \};}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classHPEQueue}{HPEQueue}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classQueue}{Queue}}}
\DoxyCodeLine{00075\ \{}
\DoxyCodeLine{00076\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{classHPEQueue}{HPEQueue}}(\mbox{\hyperlink{classThreadQueue}{hipStream\_t}}\ *\mbox{\hyperlink{classThreadQueue}{stream\_addr}});}
\DoxyCodeLine{00078\ \ \ \ \ \mbox{\hyperlink{classHPEQueue_a6630ed49cacf03cb8f658ff55807506b}{\string~HPEQueue}}();}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \mbox{\hyperlink{classQueueEntry}{QueueEntry}}\ *\mbox{\hyperlink{classHPEQueue_af5c3438f35a3ac69d37f6116ac040397}{create\_entry}}(\mbox{\hyperlink{classThreadQueue}{MPI\_Request}})\ \textcolor{keyword}{override};}
\DoxyCodeLine{00081\ \ \ \ \ \mbox{\hyperlink{classQueueEntry}{QueueEntry}}\ *\mbox{\hyperlink{classHPEQueue_ae1126038740d487f56c69760b7a54f97}{create\_send}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *,\ \textcolor{keywordtype}{int},\ \mbox{\hyperlink{classThreadQueue}{MPI\_Datatype}},\ \textcolor{keywordtype}{int},\ \textcolor{keywordtype}{int})\ \textcolor{keyword}{override};}
\DoxyCodeLine{00082\ \ \ \ \ \mbox{\hyperlink{classQueueEntry}{QueueEntry}}\ *\mbox{\hyperlink{classHPEQueue_a7d2771885b44c1fb0772ff4d16d48ab3}{create\_recv}}(\textcolor{keywordtype}{void}\ *,\ \textcolor{keywordtype}{int},\ \mbox{\hyperlink{classThreadQueue}{MPI\_Datatype}},\ \textcolor{keywordtype}{int},\ \textcolor{keywordtype}{int})\ \textcolor{keyword}{override};}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHPEQueue_a333c227b54c3fa663cb15a0d601e50bc}{enqueue\_operation}}(\mbox{\hyperlink{classQueueEntry}{QueueEntry}}\ *)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHPEQueue_ab33556aae3e6b55763310292bee3e044}{enqueue\_waitall}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHPEQueue_a27ad478ead68f729cd8ea2396d0ec7cf}{host\_wait}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00089\ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{hipStream\_t}}\ *\mbox{\hyperlink{classHPEQueue_aa1ff49b85b9238f784e6d59e5ec8dc92}{my\_stream}};}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPI\_Comm}}\ \ \ \mbox{\hyperlink{classHPEQueue_a49fca482f1693da73d3d0ceb95c437d6}{dup\_comm}};}
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{classThreadQueue}{MPIS\_Queue}}\ \mbox{\hyperlink{classHPEQueue_a77a74d973e1c1d645a23901a5524e18f}{my\_queue}};}
\DoxyCodeLine{00093\ \};}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
